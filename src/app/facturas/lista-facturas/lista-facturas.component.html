<app-loading *ngIf="loadingService.modal"></app-loading>
<app-factura-buscar></app-factura-buscar>
<app-cliente-facturar></app-cliente-facturar>
<div class="card bg-light mb-3">
<div class="card-header"><h3><strong>Facturas</strong></h3></div>
<div class="card-body">
<h4 class="card-title text-muted">Listado de Facturas</h4>
<div class="row">
  <div class="col-sm-2">
    <div class="my-2 text-left">
      <button class="btn btn-rounded btn-outline-primary btn-xs"
      type="button"
      (click)="abrirModalBuscarFactura()"
      >
        Buscar Factura
      </button>
    </div>
  </div>
  <div class="col-sm-10">
    <div class="my-2 text-left">
      <button class="btn btn-rounded btn-outline-success btn-xs"
      type="button"
      (click)="abrirModal()"
      >
        Crear Factura
      </button>
  </div>
  </div>
</div>

<div class="alert alert-info"
  *ngIf="facturas?.length == 0" >
  <span class="text-muted"><strong>No hay registros en la Base de Datos</strong></span>
</div>
<table class='table table-bordered table-striped'
            *ngIf="facturas?.length>0" >
            <thead class="bg-dark  text-white">
              <tr>
                <th >Detalle</th>
                <th>Fecha</th>
                <th>Estado</th>
                <th >Cambiar</th>
                <th >Total</th>
                <!-- <th *ngIf="authService.hasRole('ROLE_ADMIN')">eliminar</th> -->
              </tr>
            </thead>
  <tbody class="text-center">
    <tr *ngFor="let factura of facturas">
      <td class="text-center"><button class="btn btn-primary btn-sm" type="button"
        [routerLink]="['/facturas', factura._id]">ver</button>
      </td>
      <td>{{factura.createAt | date:"full"}}</td>
      <td >{{factura.estado}}</td>
      <td >
        <form [formGroup]="estadoFormulario">
          <select id="estado" formControlName="estado" 
              (change)="cambiarEstadoFactura(factura)">
              <option *ngFor="let estado of estados" 
              [ngValue]="estado">{{ estado }}</option>
          </select>
        </form>
      </td>
      <td class="text-right">{{formatNumber(factura.total)}}</td>
    </tr>
  </tbody>
</table>
</div>
</div>
